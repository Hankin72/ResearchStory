{% extends 'base.html' %}

{% block content %}
    <style type="text/css">
        div.content {
                margin: 0 auto;
                padding-top:10px;
                padding-bottom:20px;
                padding-left:15px;
                background-color:rgba(255,255,255,0.8);
            }

    </style>

    <div class="content">
        <h2>hahahaha</h2>
         <div class="all_content">
                        <!-- 显示评论 -->
                        {% load mptt_tags %}
                        <h4>Total comments: {{ comments.count }}</h4>
                        <div class="row">
                            {% recursetree comments %}
                                {% with comment=node %}
                                    <div class="{% if comment.reply_to %} offset-1 col-11 {% else %} col-12 {% endif %}">
                                        <hr/>
                                        <p>
                                            <strong style="color: pink">
                                                {{ comment.user }}
                                            </strong>
                                            <!-- 显示被回复人 -->
                                            {% if comment.reply_to %}
                                                <i class="far fa-arrow-alt-circle-right"
                                                   style="color: cornflowerblue;"
                                                ></i>
                                                <strong style="color: pink">
                                                    <span style="color: black"
                                                          class="arrow-outer">  @</span> {{ comment.reply_to }}
                                                </strong>
                                            {% endif %}

                                        </p>
                                        <div>{{ comment.body|safe }}</div>

                                        <div>
                        <span style="color: gray">
                        {{ comment.created|date:"Y-m-d H:i:s" }}
                        </span>


                                            <!-- 加载 modal 的按钮 -->
                                            {% if user.is_authenticated %}
                                                <button type="button"
                                                        class="btn btn-light btn-sm text-muted"
                                                        onclick="load_modal({{ story.id }}, {{ comment.id }})">Reply
                                                </button>
                                            {% else %}
                                                <a class="btn btn-light btn-sm text-muted"
                                                   href="{% url 'Users:login' %}">
                                                    Reply
                                                </a>
                                            {% endif %}
                                        </div>

                                        <!-- Modal -->
                                        <div class="modal fade"
                                             id="comment_{{ comment.id }}"
                                             tabindex="-1"
                                             role="dialog"
                                             aria-labelledby="CommentModalCenter"
                                             aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                                                <div class="modal-content" style="height: 480px">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="exampleModalCenterTitle">Replying
                                                            to {{ comment.user }}：</h5>
                                                    </div>
                                                    <div class="modal-body" id="modal_body_{{ comment.id }}"></div>
                                                </div>
                                            </div>
                                        </div>
                                        {% if not comment.is_leaf_node %}
                                            <div class="children">
                                                {{ children }}
                                            </div>
                                        {% endif %}
                                    </div>
                                {% endwith %}
                            {% endrecursetree %}
                        </div>



    </div>
{% endblock content %}